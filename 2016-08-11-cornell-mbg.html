<!doctype html>
<html lang="en">
<head>
<title>2016-08-11-cornell-mbg</title>
<meta charset="utf-8">
<style> * { font-family: arial, sans-serif;
font-size: 13px;
line-height: 17px; }ul.indent { list-style-type: none; }ol { list-style-type: none; padding-left:0;}body > ol { counter-reset: first second third fourth fifth sixth seventh eigth ninth tenth eleventh twelth thirteenth fourteenth fifteenth sixteenth; }ol > li:before {content: counter(first) ". " ;counter-increment: first;}ol > ol > li:before {content: counter(first) "." counter(second) ". " ;counter-increment: second;}ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) ". ";counter-increment: third;}ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) ". ";counter-increment: fourth;}ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) ". ";counter-increment: fifth;}ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) ". ";counter-increment: sixth;}ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) ". ";counter-increment: seventh;}ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) ". ";counter-increment: eigth;}ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) ". ";counter-increment: ninth;}ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) ". ";counter-increment: tenth;}ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) "." counter(eleventh) ". ";counter-increment: eleventh;}ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) "." counter(eleventh) "." counter(twelth) ". ";counter-increment: twelth;}ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) "." counter(eleventh) "." counter(twelth) "." counter(thirteenth) ". ";counter-increment: thirteenth;}ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) "." counter(eleventh) "." counter(twelth) "." counter(thirteenth) "." counter(fourteenth) ". ";counter-increment: fourteenth;}ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "."  counter(eigth) "."  counter(ninth) "."  counter(tenth) "."  counter(eleventh) "."  counter(twelth) "."  counter(thirteenth) "."  counter(fourteenth) "." counter(fifteenth) ". ";counter-increment: fifteenth;}ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "."  counter(eigth) "."  counter(ninth) "."  counter(tenth) "."  counter(eleventh) "."  counter(twelth) "."  counter(thirteenth) "."  counter(fourteenth) "."  counter(fifteenth) "."  counter(sixthteenth) ". ";counter-increment: sixthteenth;}ol{ text-indent: 0px; }ol > ol{ text-indent: 10px; }ol > ol > ol{ text-indent: 20px; }ol > ol > ol > ol{ text-indent: 30px; }ol > ol > ol > ol > ol{ text-indent: 40px; }ol > ol > ol > ol > ol > ol{ text-indent: 50px; }ol > ol > ol > ol > ol > ol > ol{ text-indent: 60px; }ol > ol > ol > ol > ol > ol > ol > ol{ text-indent: 70px; }ol > ol > ol > ol > ol > ol > ol > ol > ol{ text-indent: 80px; }ol > ol > ol > ol > ol > ol > ol > ol > ol > ol{ text-indent: 90px; }ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol{ text-indent: 100px; }ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol{ text-indent: 110px; }ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol { text-indent: 120px; }ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol{ text-indent: 130px; }ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol{ text-indent: 140px; }ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol{ text-indent: 150px; }sub{vertical-align:sub;font-size:smaller}fontarial{
  font-family:arial;
}
fonttimes-new-roman{
  font-family:times new roman;
}
fontcalibri{
  font-family: Calibri,Candara,Segoe,Segoe UI,Optima,Arial,sans-serif; 
}
fonthelvetica{
  font-family:helvetica;
}
fontcourier{
  font-family:courier;
}
fontpalatino{
  font-family:palatino;
}
fontgaramond{
  font-family: Garamond,Baskerville,Baskerville Old Face,Hoefler Text,Times New Roman,serif; 
}
fontbookman{
  font-family:bookman, Bookman Old Style;
}
fontavant-garde{
  font-family: Avant Garde,Avantgarde,Century Gothic,CenturyGothic,AppleGothic,sans-serif; 
}
*{
  font-family:inherit
}
fs8{font-size:8px};fs9{font-size:9px};fs10{font-size:10px;}fs11{font-size:11px;}fs12{font-size:12px;}fs13{font-size:13px;}fs14{font-size:14px;}fs15{font-size:15px;}fs16{font-size:16px;}fs17{font-size:17px;}fs18{font-size:18px;}fs19{font-size:19px;}fs20{font-size:20px;}</style>
</head>
<body><strong>Welcome to Cornell MBG Software Carpentry</strong><br><br><strong>Instructors:</strong><br>&nbsp;&nbsp;&nbsp; Nina Overgaard Therkildsen<br>&nbsp;&nbsp;&nbsp; Erika Mudrak<br>&nbsp;&nbsp;&nbsp; Emily Davenport<br>&nbsp;&nbsp;&nbsp;&nbsp;<br><strong>Helper:</strong><br>&nbsp;&nbsp;&nbsp; David Kent<br>&nbsp;&nbsp;&nbsp;&nbsp;<br><strong>Links:</strong><br>&nbsp;&nbsp;&nbsp; Bootcamp website: <a href="https&#x3a;&#x2F;&#x2F;erdavenport&#x2e;github&#x2e;io&#x2F;2016&#x2d;08&#x2d;11&#x2d;cornell&#x2d;mbg&#x2F;">https:&#x2F;&#x2F;erdavenport.github.io&#x2F;2016-08-11-cornell-mbg&#x2F;</a>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>Good Morning Ithaca!<br><br>The Shell<br><br>Download the data here: <a href="http&#x3a;&#x2F;&#x2F;swcarpentry&#x2e;github&#x2e;io&#x2F;shell&#x2d;novice&#x2F;setup&#x2F;">http:&#x2F;&#x2F;swcarpentry.github.io&#x2F;shell-novice&#x2F;setup&#x2F;</a><br>Folow the lessons here: <a href="http&#x3a;&#x2F;&#x2F;swcarpentry&#x2e;github&#x2e;io&#x2F;shell&#x2d;novice&#x2F;">http:&#x2F;&#x2F;swcarpentry.github.io&#x2F;shell-novice&#x2F;</a><br><br><strong>pwd </strong>shows the path to the directory where we are currently working<br><strong>ls </strong>shows all the files and folders that are in this directory (&quot;folder&quot; is the same as &quot;directory&quot;)<br><br>modify command line arguments with &quot;flags&quot;, usually letters after a dash &quot;-&quot;<br>ls --help gives a list of all these flags<br>&nbsp;<br>Google is your friend!<br><br>Tab is also your friend: hit tab to autocomplete file names while in the shell<br><br><strong>cd</strong> will change directories&nbsp;<br><br>Change directories into the shell-novice-data directories - put up orange stickies if you need help<br>where is the link to download the zip file? <a href="http&#x3a;&#x2F;&#x2F;swcarpentry&#x2e;github&#x2e;io&#x2F;shell&#x2d;novice&#x2F;setup&#x2F;">http:&#x2F;&#x2F;swcarpentry.github.io&#x2F;shell-novice&#x2F;setup&#x2F;</a><br><br>cd shortcuts:<br><ul class="indent"><li>- If you ever feel lost in your file system, you can always type &quot;cd&quot; and that will bring you back to your home directory</li><li>- cd .. will take you back one folder</li><li><br></li></ul>List out the contents of the north-pacific-gyre folder using ls<br><br>Challenge: Starting from &#x2F;Users&#x2F;amanda&#x2F;data&#x2F;, which of the following commands could Amanda use to navigate to her home directory, which is &#x2F;Users&#x2F;amanda?<br><br><strong>mkdir </strong>makes a new directory (or folder)<br><ul class="indent"><li>best practices: dont put spaces in file or folder names because in shell, spaces go between commands and arguements.&nbsp; You can get around this by putting the path in quotes, but it&#x27;s easier to not put spaces in directory names</li><li><br></li></ul><strong>rm </strong>deletes files only.&nbsp; To remove a directory, use the flag &quot;-r&quot;<br><strong>$rm -r</strong> thesis<br>BE CAREFUL!&nbsp; There is no recycle bin or trash to retrieve mistakenly deleted files here!<br><br>use up arrow to scroll through recent commands<br><br>rename the directory call thesis as dissertation, then move it one directory up<br><strong>$mv thesis&#x2F; dissertation</strong><br>$mv dissertation&#x2F; ..<br><br>get to the molecules diretory<br>$cd data-shell&#x2F;molecules<br>$ls<br><br>getting info about files<br><strong>wc </strong>counts the number of lines, words and characters in a file<br>$wc cubane.pdb<br><strong>head </strong>shows the top few lines of the files<br>$head cubane.pdb<br><strong>less </strong>prints a screen&#x27;s worth of file at a time, so you can &quot;scroll&quot; through it<br>$less cubane.pdb<br><br>Wildcards:&nbsp;<br>&nbsp;&nbsp;&nbsp; matches 0 or more characters, so&nbsp; so *.pdb matches ethane.pdb, propane.pdb, and everyfile that ends with &#8216;.pdb&#8217;.<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;wc *.pdb will do wordcount command on all files with extension *.pdb<br>&nbsp;<br>&nbsp;<br>If we run wc -l instead of just wc,the output shows only the number of lines per file:<br> <code style="font-family: monospace"></code> <code style="font-family: monospace">$ wc -l *.pdb</code> <code style="font-family: monospace"></code><br><br>Pipes!<br>rather than put the result of a wordcount on thescreen, we can put it in a file to keep for later<br><br>$wc -l *.pdb &gt;lengths.txt<br><br>print out the contents of the file to a screen&nbsp;<br>$cat lengths.txt<br><br>now lets sort the lenghts.txt file by the line number, and use hte -n flag to say that it is numerical instead of alphabetical, and put that into a new file called sorted-lengths.txt<br>$sort -n lengths.txt &gt;sorted-lengths.txt<br><br>but these two steps generate intermediate files that we dont really need, and it could make our directories get full of junk.&nbsp; Run these at the same time in one line with a pipe, whcih can be gotten on a US keyboard by pressing shift wiht the slash key above the enter key.&nbsp;&nbsp;<br><br> <code style="font-family: monospace">$ wc -l *.pdb | sort -n</code><br>This does the first command, and sends the results to the second command.&nbsp; i.e first get the line count via wc, and then with those results, sort it.&nbsp; This allows us to get the results without generating the intermediate file lengths.txt<br><br>Then we can look at the beginning of this result:<br><br> <code style="font-family: monospace">$ wc -l *.pdb | sort -n | head -n 1</code><br>___________&nbsp; break __________<br><br>Go into creatures file<br><br>Let&#x27;s make a backup of the basilisk.dat andunicorn.dat files&nbsp;<br><br>Using wildcards won&#x27;t work for copy and renaming files in bulk. Instead let&#x27;s learn how to use loops in the shell.<br><br>for filename in basilisk.dat unicorn.dat<br>do<br>head -n 3 $filename<br>done<br><br>The syntax for writing a loop in the shell is always:<br>&nbsp;&nbsp;&nbsp; for variable in list<br>&nbsp;&nbsp;&nbsp; do<br>&nbsp;&nbsp;&nbsp; something<br>&nbsp;&nbsp;&nbsp; done<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>The &quot;done&quot; signifies the end of the loop statement<br>Your variable name can be anything you want. We wrote &quot;filename&quot; above because that is intuitive, but you can say anything: carrot, onion, muffins, book, x, etc<br><br>for filename in *.dat<br>do<br>echo $filename<br>head -n 100 $filename | tail -n 20<br>done<br><br>Spaces in file names causes issues in for loops. If a file has a space in it, the loop will think each word is a separate file. You can get around this problem by wrapping the file name in parenthases. Example: My thesis.txt would be expanded to &quot;My&quot; and &quot;thesis.txt&quot; if quotes aren&#x27;t used. &quot;My thesis.txt&quot; in quotes will work though.&nbsp;<br><br>So, to do the copying:<br>&nbsp;&nbsp;&nbsp; for filename in *.dat<br>&nbsp;&nbsp;&nbsp; do<br>&nbsp;&nbsp;&nbsp; cp $filename original-$filename<br>&nbsp;&nbsp;&nbsp; done<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>What if you want to run a program on all the files of a certain type (with a certain extension)? First, let&#x27;s set up a loop that will just echo file names to make sure that file names are being written correctly. Using an echo first in your loop is always a good idea. Double check that your commands will execute how you expect them to before actually running them (and potentially messing something up):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>for datafile in *.txt<br>do<br>echo $datafile stats-$datafile<br>done<br><br>That works as expected, so let&#x27;s run the program goostats on every file:<br>for datafile in *.txt<br>do<br>bash goostats $datafile stats-$datafile<br>done<br><br>If we run this, we have no way of knowing which file it&#x27;s on. It&#x27;s better to print out the name of the file being processed to the screen so we can monitor the progress of the program.<br>for datafile in *.txt<br>do<br>echo $datafile<br>bash goostats $datafile stats-$datafile<br>done<br><br>Let&#x27;s learn how to make a script that can be run on command line.&nbsp;<br>Move back into the molecules folder&nbsp;<br><br>We&#x27;ll be using nano as our text editor, but if it doens&#x27;t work on your computer you can use any text editing software (like Notepad or Notepad ++)<br><br>Let&#x27;s save a little program called middle.sh that outputs the middle few lines of a file.<br> <code style="font-family: monospace">head -n 15 octane.pdb | tail -n 5</code><br>We can run this by typing<br>bash middle.sh&nbsp;<br><br>This is fine, but much better than just typing in these commands into the command line. Instead, we can alter the script so in can take in an argument on the command line:<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; head -n 15 &quot;$1&quot; | tail -n 5<br><br>Let&#x27;s run this giving input of what file we want to take the middle lines of:<br>bash middle.sh octane.pdb<br><br>We can run the same script now on any file to get the middle few lines of the file.&nbsp;<br><br>Let&#x27;s make a very flexible script where we can specify the number of lines from the top, the filename, and number of lines at the bottom:<br>head -n &quot;$2&quot; &quot;$1&quot; | tail -n &quot;$3&quot;<br><br>To run this:<br>&nbsp;&nbsp;&nbsp; bash middle.sh propane.pdb 20 2<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>We know what we want to input as arguments from command line into this script, but if other people use it they won&#x27;t know what we wanted. We should comment our script to remind ourselves what we expect for each variable.&nbsp;<br><br># Select lines from the middle of a file<br># Usage: bash middle.sh filename end_line number_lines<br><br>head -n &quot;$2&quot; &quot;$1&quot; | tail -n &quot;$3&quot;<br><br>Let&#x27;s make another script that sorts filenames by their length:<br># Sort filenames by their length<br># Usage: bash sorted.sh one_or_more_filenames<br><br> <code style="font-family: monospace">wc -l "$@" | sort -n</code><br>We can run this on all of the .pbd files:<br>bash sorted.sh *.pdb<br><br>Saving things like this to a script is helpful so we have a record of exactly how we ran something. If we ever need to redo this later, we can easily rerun the script.&nbsp;<br><br>Break for lunch! Be back at 12:30 for R time<br><br>___________ R lesson_________________<br>Get the data here&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><a href="http&#x3a;&#x2F;&#x2F;swcarpentry&#x2e;github&#x2e;io&#x2F;r&#x2d;novice&#x2d;inflammation&#x2F;setup&#x2F;">http:&#x2F;&#x2F;swcarpentry.github.io&#x2F;r-novice-inflammation&#x2F;setup&#x2F;</a><br><br>Download the data from above to your desktop<br><br>If you want to follow along with the lessons: <a href="http&#x3a;&#x2F;&#x2F;swcarpentry&#x2e;github&#x2e;io&#x2F;r&#x2d;novice&#x2d;inflammation&#x2F;">http:&#x2F;&#x2F;swcarpentry.github.io&#x2F;r-novice-inflammation&#x2F;</a><br><br>To figure out where you are in your filesystem, type:&nbsp;<br>get.wd()<br><br>This is the same as pwd in the shell.&nbsp;<br><br>We want to move into the same directory as where our data is stored. To change directories in R, we can use the command setwd():<br>setwd(&quot;~&#x2F;Desktop&#x2F;r-novice-inflammation-data&quot;)<br><br>dir() will list out the contents of the current directory.&nbsp;<br>dir()<br><br>If you give dir() a path, it will list out the files in that path:<br>dir(&quot;data&#x2F;&quot;)<br><br>Our data is in csv format, so let&#x27;s use the function read.csv to read in our data into R:<br>read.csv(&quot;data&#x2F;inflammation-01.csv&quot;)<br><br>If you ever need help with a function, put a ? in front of the function name. This will pop up a help menu that will tell you about the function, including parameters, and examples.&nbsp;<br><br>Let&#x27;s change some of the arguments for read.csv. For instance, there isn&#x27;t a header for this file:<br>read.csv(&quot;data&#x2F;inflammation-01.csv&quot;, header=FALSE)<br><br>Variables in R:<br>&nbsp;&nbsp;&nbsp; - If you want to store data or a value for later, you can assign it to a variable.&nbsp;<br>&nbsp;&nbsp;&nbsp; - Variables are similar as in bash: you can use almost any word and assign using either &quot;=&quot; or &quot;&lt;- &quot;&nbsp;<br><br>weight_kg &lt;- 55<br><br>You can treat variables in R just like you would treat variables in algebra. You can multiply numbers, add things, etc:<br>2.2*weight_kg<br><br>Can also make new variables from old variables:<br>weight_lb &lt;- 2.2*weight_kg<br><br>We&#x27;ve been typing into the console, but you will want to in general save all of your R code to a script. Start a new script in RStudio by going to the File menu -&gt; New File -&gt; R Script<br><br>In RStudio, you can run code directly from your script in the console by putting your cursor on a line and hitting control-r (command-enter on mac) or hitting that green run arrow up above the script. You can also select multiple lines of code to run.&nbsp;<br><br>Let&#x27;s save that file we are reading in as a variable called dat:<br>dat &lt;- read.csv(&quot;data&#x2F;inflammation-01.csv&quot;, header=FALSE)<br><br>Some useful commands to look at data in R:<br>head() # This will look at the top few rows of the data, all columns<br>tail() # This will look at the last few rows of the data, all columns<br>class(dat) # This will tell you what type of object you&#x27;re looking at.&nbsp;<br><br>Data.frame will most often be what your data is stored as if stored as a table.&nbsp;<br><br>dim(dat) # Tells you the number of rows by columns of your data table<br><br>To access certain parts of our data, we can subset using square brackets:<br>dat[1,1] # This will pull the value in the first row and the first column for you. The order when subsetting is always rows comma columns.<br><br>What if you want the first 10 observations? You can slice:<br>dat[1:10, 1:10] # The colon is what is used for slicing. It will show the first value through the 10th value, in this case.&nbsp;<br><br>What if you want every other value? c() stands for concatenate and is how you can give multiple values:&nbsp;<br>dat[c(1,3,5,7,9), 1:10] # This gives us the first 10 columns for rows 1,3,5,7,9.<br><br>If you don&#x27;t include a value when indexing, you will get all values returned:<br>dat[ ,1:10] # This will return all rows, but only the first 10 columns.&nbsp;<br><br>Let&#x27;s say we want to calculate the average inflammation for patient number 1 (aka: row 1).&nbsp;<br>First, let&#x27;s just store the information for patient 1 to a variable:<br>patient_1 &lt;- dat[1, ]<br>mean(patient_1)<br><br>We get an error if we try to run this because R is interpretting this as a data.frame. We can force R to recognize patient_1 as a bunch of numbers:<br>patient_1 &lt;- as.numeric(dat[1, ])<br>mean(patient_1)<br><br>Other useful stats functions:<br>min() # find the minimum value<br>max() # find the maxiumum value<br>sd() # find the standard deviation of values<br><br>How can we figure out what the maximum inflammation value is across everyone on day 7?<br>min(dat[,7])<br><br>What if we want to calculate the mean inflammation across all individuals at once? We can use something called an &quot;apply&quot; statement to run a function across all rows or columns of some data at the same time.&nbsp;<br>apply(X = dat, MARGIN = 1, FUN = mean)<br><br>What about mean inflammation across all patients by day? You can use the opposite margin (columns):<br>apply(X = dat, MARGIN = 2, FUN = mean)<br><br>For apply statements, you first enter the data you want to process, then the margin (the rows or the columns you want to process), and then the function you want to run over those rows.&nbsp;<br><br>Just like shell, you can comment your code using &quot;#&quot; Anything after the hashtag R will not interpret.&nbsp;<br><br>Be sure to save your scripts as you&#x27;re working on them! R scripts are saved with the .R ending.&nbsp;<br><br>R is a great tool for plotting and visualizing your data. Let&#x27;s save the results of the apply statements we made above to use them later:<br>avg_patient_inflammation &lt;- apply(X = dat, MARGIN = 1, FUN = mean)<br>avg_day_inflammation &lt;- apply(X = dat, MARGIN = 2, FUN = mean)<br><br>Let&#x27;s plot the average patient inflammation by day:<br>plot(avg_patient_inflammation) # This isn&#x27;t actually very interesting, because the order of individuals in the data isn&#x27;t meaningful<br>plot(avg_day_inflammation)<br><br>You can next functions within other functions:<br>plot(apply(X = dat, MARGIN = 2, FUN = max))<br>plot(apply(X = dat, MARGIN = 2, FUN = min))<br><br>For required arguments in functions, you don&#x27;t need to actually write out the argument name. You can list your arguments in order and R will automatically assign them to the required arguments in order:<br>apply(dat, 2, mean)&nbsp;<br>apply(X = dat, MARGIN = 2, FUN = mean) # These two lines do the same thing.&nbsp;<br><br>If you want to input arguments out of order, then you must specify the argument name:<br>apply(MARGIN = 2, X = dat, FUN = mean)<br><br>###########<br><br>Functions<br><br>Functions always take the following form:<br><br>NAME_OF_FUNCTION &lt;- function(VARIABLE) {<br>&nbsp;&nbsp;&nbsp; DO_SOME_STUFF<br>}<br><br>fahr_to_kelvin &lt;- function(temp) {<br>&nbsp;&nbsp;&nbsp; kelvin &lt;- ((temp - 32) * (5&#x2F;9)) + 273.15<br>&nbsp;&nbsp;&nbsp; return(kelvin)<br>}<br><br>To run the function data,<br><br>fahr_to_kelvin(32)<br>fahr_to_kelvin(212)<br><br>Let&#x27;s make another function that is kelvin to celsius&nbsp;<br>kelvin_to_celsius &lt;- function(temp) {<br>&nbsp;&nbsp;&nbsp; celsius &lt;- temp - 273.15<br>&nbsp;&nbsp;&nbsp; return(celsius)<br>}<br><br>kelvin_to_celsius(0)<br><br>How to convert fahrenheit to celsius incorporating the functions we&#x27;ve already written?<br>kelvin_to_celsius(fahr_to_kelvin(32)) # One way is to nest the two functions like this.&nbsp;<br><a href="http&#x3a;&#x2F;&#x2F;pad&#x2e;software&#x2d;carpentry&#x2e;org&#x2F;2016&#x2d;08&#x2d;11&#x2d;cornell&#x2d;mbg">http:&#x2F;&#x2F;pad.software-carpentry.org&#x2F;2016-08-11-cornell-mbg</a><br>Challenge! Make a brand new function that takes in fahrenheight and returns celsius, using the two functions we&#x27;ve previously generated:<br>fahr_to_celsius &lt;- function(temp) {<br><ul class="indent"><li>temp_k &lt;- fahr_to_kelvin(temp)</li><li>temp_c &lt;- kelvin_to_celsius(temp_k)</li><li>return(temp_c)</li></ul>}<br><br>A note about functions: any variables that you create within a function disappear once the function is done running. This is good, because these temp variables won&#x27;t muddy up your working space.&nbsp;<br><br><br>################<br><br>Let&#x27;s move away from making functions for temperature conversions. Let&#x27;s make a function that will center our data:<br><br>center &lt;- function(data, desired) {<br>&nbsp;&nbsp;&nbsp; new_data &lt;- (data - mean(data)) + desired<br>&nbsp;&nbsp;&nbsp; return(new_data)<br>}<br><br>Aside about saving workspace images when you exit R: It seems like you may want to save workspace images, which means when you open R the next time you&#x27;ll get back everything you were working on today as it is. However, this isn&#x27;t the best practice for reproducible research. You want all of your steps to be recorded in a script so you or anyone else can redo it. If you save the workspace image, all of your typos and mistakes are saved as well!<br><br>------ Break -------<br><br>Before the break we were making a function that will center data. Let&#x27;s test out that function on a list of just zeros:<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>z &lt;- c(0,0,0,0)<br>center(z, 3)<br><br>Let&#x27;s run the center function on the 4th day inflammation values:<br>centered &lt;- center(dat[,4], 0)<br><br>How do we know if it worked right? Let&#x27;s compare some stats from the original data to the centered data:<br>min(data[,4])<br>mean(dat[,4])<br>max(dat[,4])<br>min(centered)<br>mean(centered)<br>max(centered)<br><br>We can see that things are shifted to a mean of 0 and that the min and max values have shifted as well.<br><br>We know if we centered the data only that the standard deviation should not have changed. let&#x27;s make sure they match:<br>sd(dat[,4])<br>sd(centered)<br><br>R only shows so many significant digits to the screen, but it stores many more than that. To compare you can do these types of checks:<br>sd(dat[,4] - sd(centered) # this should equal 0<br>all.equal(sd(dat[,4]), sd(centered))<br><br>You should always do a few sanity checks like this when you write your own functions to make sure they are working the way you intended them to.&nbsp;<br><br>When you write a function, you probably want to include a description of the function and an example of how it&#x27;s used in the function itself, similar to what we did when writing a script in the shell:<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>center &lt;- function(data, desired) {<br>&nbsp;&nbsp;&nbsp; # return a new vector containing hte original data (data)<br>&nbsp;&nbsp;&nbsp; # centered around the desired value (desired)<br>&nbsp;&nbsp;&nbsp; # Example center(c(1,2,3), 0) =&gt; c(-1,0,1)<br>&nbsp;&nbsp;&nbsp; new_data &lt;- (data - mean(data)) + desired<br>&nbsp;&nbsp;&nbsp; return(new_data)<br>}<br><br>###########################<br>Let&#x27;s write a function called analyze that takes in a file name and displays min, average, and max inflammation of all patients by day.&nbsp;&nbsp;<br><br>analyze &lt;- function(filename) {<br>&nbsp;&nbsp;&nbsp; # This function takes a file name as an argument (should be a csv file) and displays graphs of the min, mean, and max for all patients for each day.<br>&nbsp;&nbsp;&nbsp; dat &lt;- read.csv(filename, header=FALSE)<br>&nbsp;&nbsp;&nbsp; plot(apply(dat, 2, max))<br>&nbsp;&nbsp;&nbsp; plot(apply(dat, 2, min))<br>&nbsp;&nbsp;&nbsp; plot(apply(dat, 2, mean))<br>&nbsp;&nbsp;&nbsp; print(&quot;done&quot;)<br>}<br><br>analyze(&quot;data&#x2F;inflammation-01.csv&quot;)<br>analyze(&quot;data&#x2F;inflammation-02.csv&quot;)<br><br>Ta-da! Our function works on any file name that we give it.&nbsp;<br><br>Some guidelines for writing code, in the order that they matter:<br>&nbsp;&nbsp;&nbsp; 1. It should work!<br>&nbsp;&nbsp;&nbsp; 2. It should be readable to human<br>&nbsp;&nbsp;&nbsp; 3. It should be efficient<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>In general, it&#x27;s not a good use of your time to spend optimizing your code to be as fast as possible if you don&#x27;t have it working yet. Also, it&#x27;s more important for you to be able to use your code later, so be sure to make it human readable.&nbsp;<br><br>For loops<br>best_practice &lt;- c(&quot;Let&quot;, &quot;the&quot;, &quot;computer&quot;, &quot;do&quot;, &quot;the&quot;, &quot;work&quot;)<br>best_practice[1]<br>print_words &lt;- function(sentence) {<br>&nbsp;&nbsp;&nbsp; print(sentence[1])<br>&nbsp;&nbsp;&nbsp; print(sentence[2])<br>&nbsp;&nbsp;&nbsp; print(sentence[3])<br>&nbsp;&nbsp;&nbsp; print(sentence[4])<br>&nbsp;&nbsp;&nbsp; print(sentence[5])<br>&nbsp;&nbsp;&nbsp; print(sentence[6])<br>}<br><br>print_words(best_practice)<br><br>Is there a limitation in this function? Will it work for all sentences? [spoiler: nope!]<br>new_sentence &lt;- c(&quot;this&quot;, &quot;is&quot;, &quot;my&quot;, &quot;second&quot;, &quot;sentence&quot;)<br>print_words(new_sentence)<br><br>Is this what we wanted? Nope, there&#x27;s an NA.&nbsp;<br><br>What can we do to make this function more flexible, so that it works on sentences with variable length? Let&#x27;s add a for loop to the function<br><br>print_words &lt;- function(sentence) {<br>&nbsp;&nbsp;&nbsp; for (word in sentence) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print(word)<br>&nbsp;&nbsp;&nbsp; }<br>}<br><br>print_words(new_sentence)<br><br>a_longer_sentence &lt;- c(&quot;this&quot;, &quot;is&quot;, &quot;a&quot;, &quot;very&quot;, &quot;very&quot;, &quot;long&quot;, &quot;sentence&quot;, &quot;but&quot;, &quot;not&quot;, &quot;really&quot;, &quot;that&quot;, &quot;long&quot;)<br>print_words(a_longer_sentence)<br><br>len &lt;- 0<br>vowels &lt;- c(&quot;a&quot;, &quot;e&quot;, &quot;i&quot;, &quot;o&quot;, &quot;u&quot;)<br>for (v in vowels) {<br>&nbsp;&nbsp;&nbsp; len &lt;- len + 1<br>}<br><br>Count the even numbers:<br>mynumbers &lt;- c(2,7,8,2,3,4,6,7,8,2,3,4)<br>evens &lt;- 0<br>for (num in mynumbers) {<br>&nbsp;&nbsp;&nbsp; if (num %% 2 == 0) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; evens &lt;- evens + 1<br>&nbsp;&nbsp;&nbsp; }<br>}<br><br>Now that we understand loops, let&#x27;s go back to our analyze function. We want to run the analyze function on every data file that is sitting in our data folder. How can we do that automatically in R, without having to write out each file name?<br><br>First, get a list of files that sit in the directory:<br>list.files(path=&quot;data&#x2F;&quot;)<br><br>This lists out every file in the directory. Let&#x27;s only list out the files that say &quot;inflammation&quot; and save those into a variable:<br>filenames &lt;- list.files(path=&quot;data&#x2F;&quot;, pattern=&quot;inflammation&quot;, full.names=TRUE)&nbsp;&nbsp; # full.names = TRUE means that the path before the file names will be included<br><br>for (f in filenames) {<br>&nbsp;&nbsp;&nbsp; print(f)<br>&nbsp;&nbsp;&nbsp; analyze(f)<br>}<br><br>This function prints out all the plots as individual files. That&#x27;s a lot of scrolling. Let&#x27;s modify the analyze script so that it displays the min, mean, and max plots for each file on the same page:<br><br>analyze &lt;- function(filename) {<br>&nbsp;&nbsp;&nbsp; # This function takes a file name as an argument (should be a csv file) and displays graphs of the min, mean, and max for all patients for each day.<br>&nbsp;&nbsp;&nbsp; dat &lt;- read.csv(filename, header=FALSE)<br>&nbsp;&nbsp;&nbsp; par(mfrow=c(3,1))<br>&nbsp;&nbsp;&nbsp; plot(apply(dat, 2, max))<br>&nbsp;&nbsp;&nbsp; plot(apply(dat, 2, min))<br>&nbsp;&nbsp;&nbsp; plot(apply(dat, 2, mean))<br>&nbsp;&nbsp;&nbsp; print(&quot;done&quot;)<br>}<br><br>Challenge!&nbsp;<br>Write a function called &quot;analyze_all&quot; that takes a filename pattern as one argument and the path to the folder holding the data to be analyzed as another and runs the function analyze for each file whose name matches the pattern<br><br>analyze_all &lt;- function(folder, pattern) {<br>&nbsp;&nbsp;&nbsp; # Runs the analyze function for each file in the directory &quot;folder&quot; that matches the filename pattern &quot;pattern&quot;.<br>&nbsp;&nbsp;&nbsp; filenames &lt;- list.files(path=folder, pattern=pattern, full.names=TRUE)&nbsp;<br>&nbsp;&nbsp;&nbsp; for (f in filenames) {<br><ul class="indent"><li>&nbsp;&nbsp;&nbsp; print(f)</li><li>&nbsp;&nbsp;&nbsp; analyze(f)</li><li>}</li></ul>}<br><br><br><br>Day 2:<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>We&#x27;ll be starting this morning with Git. Lessons: <a href="http&#x3a;&#x2F;&#x2F;erdavenport&#x2e;github&#x2e;io&#x2F;git&#x2d;lessons&#x2F;index&#x2e;html">http:&#x2F;&#x2F;erdavenport.github.io&#x2F;git-lessons&#x2F;index.html</a><br>If you want to follow the commands as I type them: <a href="https&#x3a;&#x2F;&#x2F;www&#x2e;dropbox&#x2e;com&#x2F;s&#x2F;mtn8ui0yp1s99yv&#x2F;git&#x5f;commands&#x2e;txt&#x3f;dl&#x3d;0">https:&#x2F;&#x2F;www.dropbox.com&#x2F;s&#x2F;mtn8ui0yp1s99yv&#x2F;git_commands.txt?dl=0</a><br><br>Why do we want to use version control?<br>-Keep track of versions (avoid the final, final_forreal, final_really_really files)<br>-Collaboration (share code and manage and document who is editing what when and why)<br>-For the future you - keep track of changes (what seems obvious to you now, but not 6 months down the road)<br><br>Example:&nbsp;<br>&nbsp;&nbsp;&nbsp; A mission to Mars: Wolfman and Dracula need to work together to plan it<br>&nbsp;&nbsp;&nbsp; Before they either worked on a project in sequence or always together; didn&#x27;t work well<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>After you commit something to git, it&#x27;s never lost (saved in the cloud, automatic backup)<br><br>git config --global user.name &quot;NAME&quot;&nbsp; # use your real name<br>git config --global user.email &quot;EMAIL ADDRESS&quot;<br>git config --global color.ui &quot;auto&quot;<br>git config --list<br><br>Git is going to track a folder on your computer - a convenient way to organize files for projects<br><br>In the shell:<br>Go to your home directory<br>cd<br>mkdir planets<br>cd planets<br>git init<br>ls<br>ls -a<br># you&#x27;ll see that git has greated the hidden folder .git<br># If you by accident git initialize a folder, you can just delete the hidden .git file (but that will delete your entire version control history<br># Once you have initialized a directory, it will version control in all subdirectories. So it&#x27;s generally a bad idea to nest git folders (i.e. to make a subdirectory within a Git directory and second Git directory (because changes in this folder will already be tracked in the parent Git folder)<br><br>git status<br><br>nano mars.txt<br>Type &quot;Cold and dry, but everything is my favorite color&quot;<br><br>NOTE: On Windows: can type &quot;notepad.exe mars.txt&quot; to start or edit a text file in notepad<br><br># Check what&#x27;s in the file<br>cat mars.txt&nbsp;<br><br>git status<br># Output: &quot;nothing added to commit but untracked files present (use &quot;git add&quot; to track)&quot;<br># We see a new file in the folder. Git is saying that it sees it, but it not doing anything with it yet<br><br>git add mars.txt<br><br>git status<br># Now we&#x27;ve told git to pay attention to this file, but we haven&#x27;t actually told it to keep track of it yet<br><br>git commit -m &quot;Start notes on Mars as base&quot;<br># If you don&#x27;t include a message, git is going to ask what you changed<br># Git will only save changes when you commit (so different from autosave and from word where you can undo every change<br># Each commit gets a unique barcode<br># What happens is that we store the changes in the hidden git directory (you won&#x27;t see any new files when you type ls (you will only see a single version of your file, but you can access all older versions through the hidden git folder))<br><br>What is a good commit message?:<br>&nbsp;&nbsp;&nbsp; Short, so you can quickly read through (50 characters or so)<br>&nbsp;&nbsp;&nbsp; Be specific and informative (don&#x27;t just say &quot;fix types&quot;)<br><br>Why separate steps for add and commit?:<br>&nbsp;&nbsp;&nbsp; Sometimes you&#x27;re making changes to multiple different files at once and want to track a change in one before you&#x27;re finished editing the other<br>&nbsp;&nbsp;&nbsp; Typically you would commit immediately after adding<br>&nbsp;&nbsp;&nbsp;&nbsp;<br># Type more text in our mars.txt<br><br>nano mars.txt<br>&quot;The two moons may be a program for Wolfman&quot;<br><br>cat mars.txt<br><br>git status<br><br>git add mars.txt<br># This stages the file to prepare for committing the change<br><br>git diff --staged<br># Compare our staged version to the already committed version<br># The output is a little cryptic, but there are different GUIs you can add on to get an output that is easier to interpret<br><br>git commit -m &quot;Add converns about the effects of Mars&#x27; moons on Wolfman&quot;<br><br>nano mars.txt<br>&quot;But the mummy will appreciate the lack of humidity&quot;<br><br>cat mars.txt<br><br>cat diff<br><br>git commit -m &quot;added notes about humidity&quot;<br># This does not commit anything because the modified file hasn&#x27;t been staged<br><br>git add mars.txt<br>git status<br><br>git commit -m &quot;added notes about humidity&quot;<br><br># General rule: commit early and often (every time you think you might want to go back to a previous version)<br><br><br>Compare to specific older versions of commits:<br>git diff HEAD~1 mars.txt&nbsp;<br>git diff HEAD~2 mars.txt&nbsp;<br><br><br>But when you have lots of commits, it may be more helpful to look at the commit history (shows you what changes have been made when and by whom:&nbsp;<br><br>git log<br><br>Can use the unique git commit identifier (seen in the commit log history) to compare to a specific previous version (you don&#x27;t need to type the entire identifier, you can just put in the first characters)<br><br>e.g.<br>git diff 89b0e779 mars.txt&nbsp;<br>git diff 89b0be77 mars.txt<br><br>To look at the most recent versions, you can use the diff HEAD command, for changes made longer ago, the history is more useful<br><br>What if we accidentally overwrite our file?<br><br>nano mars.txt<br>Delete everything in the file and type instead:<br>&quot;We will need to manufacture our own oxygen&quot;<br><br># Pull back the last commited version<br>git checkout HEAD mars.txt<br>[Now we hadn&#x27;t saved the changes we had made under a different name, so we lost those changes. If we had wanted to keep them as another document, we should have saved and committed them before doing the checkout]<br><br>In your file system you will only see the version that you currently have checked out<br><br><br>####### BREAK<br><br><br>If you want to clear off your Terminal screen, you can type &quot;clear&quot;<br><br><br>Git is best for tracking simple text files, not binary files like images etc.<br><br>Create a series of files:<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>touch a.dat b.dat c.dat<br>mkdir results<br>touch results&#x2F;a.dat results&#x2F;b.dot<br><br>git status<br><br>Create an ignore file<br>nano .gitignore<br><br>Type:<br>*.dat&nbsp; # All files with a .dat extension<br>results&#x2F;&nbsp; # All files in the results folder<br><br>git status<br># Now you only see the .gitignore file. We want to commit that so other users can also see it)<br><br>git add .gitignore<br>git commit -m &quot;added gitignore file&quot;<br><br><br>-------------------------------<br><br>How to use Github to sync files between your computers<br><br>Github is free as long as keep your repositories public<br>Bitbucket is very similar to Github, but allows private repositories for free<br><br>Go to Github.com<br><br>Create an account or sign in<br><br>Create a new repository<br>Give it the same name as the git directory you just created in your home folder (planets)<br><br>Type into the shell:<br>git remote add origin <a href="https&#x3a;&#x2F;&#x2F;github&#x2e;com&#x2F;erdavenport&#x2F;planets&#x2e;git">https:&#x2F;&#x2F;github.com&#x2F;erdavenport&#x2F;planets.git</a><br>git remote -v<br><br>Using github is not like using dropbox, transfers of files don&#x27;t happen automatically, you have to push it<br><br>git push origin master<br><br>Now you can see the files you committed on your computer in your Github web interface<br><br>Next we&#x27;ll be pulling files from the internet to our computer<br><br>git pull origin master<br><br>Now we&#x27;ll simulate what it&#x27;s like to collaborate with someone (or yourself across multiple computers)<br><br>cd &#x2F;tmp<br>git clone <a href="https&#x3a;&#x2F;&#x2F;github&#x2e;com&#x2F;erdavenport&#x2F;planets&#x2e;git">https:&#x2F;&#x2F;github.com&#x2F;erdavenport&#x2F;planets.git</a><br>ls<br><br>cd planets<br>nano pluto.txt<br><br>Add this file to the repository<br><br>git add pluto.txt<br>git commit -m &quot;Some notes about Pluto&quot;<br>git status<br><br>Now we want to push this up to our remote repository<br><br>git push origin master<br>(will ask for user name and password)<br><br>Now we have the Pluto file in our tmp directory and our online directory. Now we want to pull it to our planets folder in our home directory<br><br>cd ~&#x2F;planets&#x2F;<br>ls pwd<br><br>git pull origin master<br><br>But what happens if two people have made changes to the same file and both push them onto the master?<br><br>Let&#x27;s have a look<br><br>In the home directory type<br><br>nano&nbsp; mars.txt<br>&quot;This line was added in the home directory&quot;<br>git add mars.txt<br>git commit -m &quot;adding a line in our home directory&quot;<br>git push orgin master<br><br>Now make a change in the copy in the temporary folder, commit those changes and push to the remote<br><br>cd &#x2F;tmp&#x2F;planets&#x2F;<br>&quot;We added a different line to the temporary copy&quot;<br>git add mars.txt<br>git commit -m &quot;adding a line in our home directory&quot;<br>git push orgin master<br><br>These changes were rejected because you had not been making the changes in the most recent version online<br>You therefore first need to pull the current version and merge<br><br>git pull origin master<br>You will get an error message telling you that git doesn&#x27;t know which of your changes you would like to keep and that you need to resolve the conflict<br><br>Open the file with nano and you will see the two conflicting changes<br>nano mars.txt<br>You can edit this to remove the conflict<br><br>git commit -m &quot;Merging changes from github&quot;<br>git push origin master<br><br>Now our temporary directory has this new file, as does the online repo, but we still have an older version in our home directory<br>cd ~&#x2F;planets<br>git pull origin master<br><br><br>Clone the repository created by your instructor. Add a new file to it, and modify an existing file (your instructor will tell you which one). When asked by your instructor, pull her changes from the repository to create a conflict, then resolve it.<br><br><br><br><br><br><br>#################&nbsp; R lessons Friday Afternoon ####################<br><br>Lessons for today: <a href="http&#x3a;&#x2F;&#x2F;swcarpentry&#x2e;github&#x2e;io&#x2F;r&#x2d;novice&#x2d;inflammation&#x2F;">http:&#x2F;&#x2F;swcarpentry.github.io&#x2F;r-novice-inflammation&#x2F;</a><br>- We&#x27;re going to do &quot;making choices&quot;<br><br>Get the data here&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><a href="http&#x3a;&#x2F;&#x2F;swcarpentry&#x2e;github&#x2e;io&#x2F;r&#x2d;novice&#x2d;inflammation&#x2F;setup&#x2F;">http:&#x2F;&#x2F;swcarpentry.github.io&#x2F;r-novice-inflammation&#x2F;setup&#x2F;</a><br><br> <code style="font-family: monospace">analyze <- function(filename) {</code> <code style="font-family: monospace">  # Plots the average, min, and max inflammation over time.</code> <code style="font-family: monospace">  # Input is character string of a csv file.</code> <code style="font-family: monospace">  dat <- read.csv(file = filename, header = FALSE)</code> <code style="font-family: monospace">  avg_day_inflammation <- apply(dat, 2, mean)</code> <code style="font-family: monospace">  plot(avg_day_inflammation)</code> <code style="font-family: monospace">  max_day_inflammation <- apply(dat, 2, max)</code> <code style="font-family: monospace">  plot(max_day_inflammation)</code> <code style="font-family: monospace">  min_day_inflammation <- apply(dat, 2, min)</code> <code style="font-family: monospace">  plot(min_day_inflammation)</code> <code style="font-family: monospace">}</code><br><br><br><br> <code style="font-family: monospace">analyze_all <- function(pattern) {</code> <code style="font-family: monospace">  # Runs the function analyze for each file in the current working directory</code> <code style="font-family: monospace">  # that contains the given pattern.</code> <code style="font-family: monospace">  filenames <- list.files(path = "data", pattern = pattern, full.names = TRUE)</code> <code style="font-family: monospace">  for (f in filenames) {</code> <code style="font-family: monospace">    analyze(f)</code> <code style="font-family: monospace">  }</code> <code style="font-family: monospace">}</code><br>To get started, let&#x27;s make a new project in R studio. Go to File -&gt; New Project. Navigate to the r-novice-inflammation folder and set that as your R project folder.&nbsp;<br>Within an R project, it will automatically set your directories to your project folder, which is handy when you&#x27;re coming back to something later.&nbsp;<br><br>How can we save out plots to files?<br>pdf(&quot;simpleplot.pdf&quot;) # This opens a connection to your file system<br>plot(1:10, 1:10) # This will plot a scatter plot&nbsp;<br>abline(h=6)<br>dev.off() # This closes the connection to the file system. You have to run this or you won&#x27;t be able to open your files.&nbsp;<br><br>Anything you write between pdf() and dev.off() will be plotted, so you can combine multiple plots on to one sheet or add things to one plot (a trendline for example).<br><br>Pdf() will overwrite plots if they&#x27;re named the same thing.&nbsp;<br><br># Side lesson on conditionals<br>num &lt;- 37<br><br>if (num &gt; 100) {<br>&nbsp;&nbsp;&nbsp; print(&quot;greater&quot;)<br>} else {<br>&nbsp;&nbsp;&nbsp; print(&quot;not greater&quot;)<br>}<br><br>num &lt;- 150<br><br>if (num &gt; 100) {<br>&nbsp;&nbsp;&nbsp; print(&quot;greater&quot;)<br>} else {<br>&nbsp;&nbsp;&nbsp; print(&quot;not greater&quot;)<br>}<br><br>You don&#x27;t always have to include an else statement in a conditional. For instance:<br>if (num &gt; 100) {<br>&nbsp;&nbsp;&nbsp; print(&quot;greater&quot;)<br>}<br><br>That function will print &quot;greater&quot; if the number is greater than 100 and not print anything if the number is less that 100.<br><br>You can continue to make choices use else if statements:<br>if (num &gt; 100) {<br>&nbsp;&nbsp;&nbsp; print(&quot;greater&quot;)<br>} else if (num &lt; 50) {<br>&nbsp;&nbsp;&nbsp; print(&quot;less than 50&quot;)<br>} else {<br>&nbsp;&nbsp;&nbsp; print(&quot;50&lt;=x&lt;=100&quot;)<br>}<br><br>Let&#x27;s write a general function that will test whether a number is positive, negative, or zero.&nbsp;<br>sign &lt;- function(num) {<br>&nbsp;&nbsp;&nbsp; if (num &gt; 0) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return(1)<br>&nbsp;&nbsp;&nbsp; } else if (num == 0) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return(0)<br>&nbsp;&nbsp;&nbsp; } else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return(-1)<br>&nbsp;&nbsp;&nbsp; }<br>}<br><br>You can also combine tests using &quot;&amp;&quot;, which means AND<br>if (1 &gt; 0 &amp; -1 &gt; 0) {<br>&nbsp;&nbsp;&nbsp; print(&quot;both parts are true&quot;)<br>} else {<br>&nbsp;&nbsp;&nbsp; print(&quot;at least one of the parts is not true&quot;)<br>}<br><br>We can also combine tests using &quot;|&quot;, which means OR<br>if (1 &gt; 0 | -1 &gt; 0) {<br>&nbsp;&nbsp;&nbsp; print(&quot;at least one of these is true&quot;)<br>} else {<br>&nbsp;&nbsp;&nbsp; print(&quot;neither part is true&quot;)<br>}<br><br>Let&#x27;s write a function plot_dist that plots a boxplot if the length of the vector is greater than a threshold that you specify. It will plot a stripchart otherwise.&nbsp;<br><br>To demonstrate boxplots and stripcharts, let&#x27;s read in data from inflammation-01:<br>dat &lt;- read.csv(&quot;data&#x2F;inflammation-01.csv&quot;, header=FALSE)<br><br>boxplot(dat[,10])<br>stripchart(dat[,10])<br><br>plot_dist &lt;- function(x, threshold) {<br>&nbsp;&nbsp;&nbsp; if (length(x) &gt; threshold) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; boxplot(x)<br>&nbsp;&nbsp;&nbsp; } else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stripchart(x)<br>&nbsp;&nbsp;&nbsp; }<br>}<br><br>mydat &lt;- c(4,7,8,3,5,6,7,8,9,2,23,4,6,7,7,8,3,5,6,7)<br>length(mydat)<br><br>plot_dist(mydat, 10)<br>plot_dist(mydat, 50)<br><br>What if you want to plot a histogram?<br>hist(dat[,10])<br><br>Let&#x27;s edit our function to add argument &quot;use_boxplot&quot; (default), but if use_boxplot=FALSE then we use a histogram<br><br>plot_dist &lt;- function(x, threshold, use_boxplot=FALSE) {<br>&nbsp;&nbsp;&nbsp; if (length(x) &gt; threshold &amp; use_boxplot) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; boxplot(x)<br>&nbsp;&nbsp;&nbsp; } else if (length(x) &gt; threshold &amp; !use_boxplot) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hist(x)<br>&nbsp;&nbsp;&nbsp; } else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stripchart(x)<br>&nbsp;&nbsp;&nbsp; }<br>}<br><br><br> <code style="font-family: monospace">analyze <- function(filename, output=NULL) {</code> <code style="font-family: monospace">  # Plots the average, min, and max inflammation over time.</code> <code style="font-family: monospace">  # Input is character string of a csv file.</code>&nbsp; if (!is.null(output)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pdf(output)<br>&nbsp; }<br>&nbsp;&nbsp;<br> <code style="font-family: monospace">  dat <- read.csv(file = filename, header = FALSE)</code> <code style="font-family: monospace">  avg_day_inflammation <- apply(dat, 2, mean)</code> <code style="font-family: monospace">  plot(avg_day_inflammation)</code> <code style="font-family: monospace">  max_day_inflammation <- apply(dat, 2, max)</code> <code style="font-family: monospace">  plot(max_day_inflammation)</code> <code style="font-family: monospace">  min_day_inflammation <- apply(dat, 2, min)</code> <code style="font-family: monospace">  plot(min_day_inflammation)</code>&nbsp;&nbsp;<br>&nbsp; if(!is.null(output)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dev.off()<br>&nbsp; }<br> <code style="font-family: monospace">}</code><br>analyze(&quot;data&#x2F;inflammation-01.csv&quot;, output=&quot;inflammation-01.pdf&quot;)<br>analyze(&quot;data&#x2F;inflammation-02.csv&quot;, output=&quot;inflammation-02.pdf&quot;)<br><br>A tip on best practice: It&#x27;s best not to save results and data in the same folder. Let&#x27;s create a new folder using R called &quot;results&quot;)<br><br>dir.create(&quot;results&quot;)<br><br>analyze(&quot;data&#x2F;inflammation-01.csv&quot;, output=&quot;results&#x2F;inflammation-01.pdf&quot;)<br> <code style="font-family: monospace"></code> <code style="font-family: monospace">This is great, but we still need to type the name of each file. </code> <code style="font-family: monospace"></code>We want to have all output files have the same name as input files, but with the pdf extension.<br><br>We can use sub to replace characters in strings<br><br>sub(pattern=&quot;csv&quot;, replacement=&quot;pdf&quot;, &quot;inflammation-01.csv&quot;)<br><br>f &lt;- &quot;inflammation-01.pdf&quot;<br><br>sub(pattern=&quot;csv&quot;, replacement=&quot;pdf&quot;, f)<br><br>file.path(&quot;results&quot;, sub(&quot;csv&quot;, &quot;pdf&quot;, f))<br><br> <code style="font-family: monospace"># Directory name for the data</code><br> <code style="font-family: monospace">analyze_all <- function(pattern) {</code>&nbsp; data_dir &lt;- &quot;data&quot;<br>&nbsp; results_dir &lt;- &quot;results&quot;<br> <code style="font-family: monospace">  # Runs the function analyze for each file in the current working directory</code> <code style="font-family: monospace">  # that contains the given pattern.</code> <code style="font-family: monospace">  filenames <- list.files(path = data_dir, pattern = pattern, full.names = FALSE)</code> <code style="font-family: monospace">  for (f in filenames) {</code>&nbsp;&nbsp;&nbsp; pdf_name &lt;- file.path(results_dir, sub(&quot;csv&quot;, &quot;pdf&quot;, f))<br> <code style="font-family: monospace">    analyze(file.path(data_dir, f), output=pdf_name)</code> <code style="font-family: monospace">  }</code> <code style="font-family: monospace">}</code><br>analyze_all(&quot;inflammation&quot;)<br><br>That&#x27;s cool, because it allows you to process all of the data in your folder in one command.&nbsp;<br><br>One issue with that function though, is that the data and results paths are set in the function. Let&#x27;s make the function more generalizable so that the user can input their own data and results directories:<br>&nbsp;&nbsp;&nbsp;&nbsp;<br> <code style="font-family: monospace">analyze_all <- function(pattern, data_dir, results_dir) {</code> <code style="font-family: monospace">  # Runs the function analyze for each file in the current working directory</code> <code style="font-family: monospace">  # that contains the given pattern.</code> <code style="font-family: monospace">  filenames <- list.files(path = data_dir, pattern = pattern, full.names = FALSE)</code> <code style="font-family: monospace">  for (f in filenames) {</code> <code style="font-family: monospace">    pdf_name <- file.path(results_dir, sub("csv", "pdf", f))</code> <code style="font-family: monospace">    analyze(file.path(data_dir, f), output=pdf_name)</code> <code style="font-family: monospace">  }</code> <code style="font-family: monospace">}</code><br>analyze_all(pattern=&quot;inflammation&quot;, data_dir=&quot;data&quot;, results_dir=&quot;results&quot;)<br><br>Break! Be back by 2:45<br><br>Creating dynamic documents using RMarkdown and KnitR<br><br>Since we&#x27;re starting something new, let&#x27;s clear out our workspace. We can do this by shutting out of RStudo, or we can click the little broomicon in the environment tab. Additionally, you can use the console and type rm( ). In the brackets you can put the variable that you want to drop. To remove everything, type rm(ls()).<br><br>To create an RMarkdown report, click new file -&gt; RMarkdown. You may have to install some packages if you don&#x27;t have some packages loaded.&nbsp;<br>If you need to install packages, go to the packages tab and type RMarkdown to install that package.&nbsp;<br><br>Once that&#x27;s done, go to File -&gt; RMarkdown. Fill in the title and author but leave it set to &quot;Document&quot;<br><br>Rmarkdown contains two things: R code &quot;chunks&quot; which is where you can type R code and R will evaluate that code. The rest of the document is text, formatting with a formatting language called markdown. By combining R &quot;chunks&quot; and markdown, you can combine descriptions and text with the output of your actual code. You can write full reports that fully integrate your analysis and results.&nbsp;<br><br>If you want a brief cheat sheet for writing in markdown: <a href="https&#x3a;&#x2F;&#x2F;github&#x2e;com&#x2F;adam&#x2d;p&#x2F;markdown&#x2d;here&#x2F;wiki&#x2F;Markdown&#x2d;Cheatsheet">https:&#x2F;&#x2F;github.com&#x2F;adam-p&#x2F;markdown-here&#x2F;wiki&#x2F;Markdown-Cheatsheet</a><br><br>R best practices:<br>&nbsp;&nbsp;&nbsp; - If you update a function, delete any intermediate functions that you won&#x27;t want to save later. Your scripts should be exactly the code you will use to analyze your data.&nbsp;<br>&nbsp;&nbsp;&nbsp; - Start your scripts with a description of what the code is for, who wrote it, and when you wrote it<br>&nbsp;&nbsp;&nbsp; - First thing, include what libraries you are going to load (for instance, rmarkdown) at the top of your script. Then people reading your script will see those libraries right away and know to download them.&nbsp;<br>&nbsp;&nbsp;&nbsp; - Include your sessionInfo() every time you run a script. This will let you know what version of R, what type of computer, and what versions of packages were run when the script was run. This is helpful if you need to recreate results later and can&#x27;t. Sometimes there are version conflicts or operating system conflicts.&nbsp;<br>&nbsp;&nbsp;&nbsp; - Helpful tip in RStudio control-shift-c will put a hashtag in front of everything that is highlighted, turning it into one big comment.<br>&nbsp;&nbsp;&nbsp; - Another helpful RStudio tip: if you have a comment in your script to start a new section, you can add a string of dashes after the word and it&#x27;ll then be collapsable (eg. # My analyze function ----)<br>&nbsp;&nbsp;&nbsp; - If you&#x27;re going to reuse a function over and over in different scripts, save your functions in separate files. You can then &quot;source&quot; these files into R. This will load those functions. It saves you having to copy and paste those functions into any scripts that you might use them in. If you update the function, then you only need to update one function, rather than going through file by file and updating the function.&nbsp;<br>&nbsp;&nbsp;&nbsp; - There are also guidelines for styles of how to write code. You can use either the Google R style guide (<a href="https&#x3a;&#x2F;&#x2F;google&#x2e;github&#x2e;io&#x2F;styleguide&#x2F;Rguide&#x2e;xml&#x29;">https:&#x2F;&#x2F;google.github.io&#x2F;styleguide&#x2F;Rguide.xml)</a> or Hadley Wickham&#x27;s style guide (<a href="http&#x3a;&#x2F;&#x2F;adv&#x2d;r&#x2e;had&#x2e;co&#x2e;nz&#x2F;Style&#x2e;html&#x29;">http:&#x2F;&#x2F;adv-r.had.co.nz&#x2F;Style.html)</a>. The most important thing is to be consistent.&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>R data types:<br>&nbsp;&nbsp;&nbsp; - Several types of data: characters (words), intergers (1,2,3,4), numeric (anything with a decimal), logical (true or false),&nbsp;<br>&nbsp;&nbsp;&nbsp; - You can ask what type of object a variable is - class(object)<br>&nbsp;&nbsp;&nbsp; - You can reassign class types. To make a numer a character: as.character(4) will return &quot;4&quot; (in quotes)<br>&nbsp;&nbsp;&nbsp; - A vector is a series of single objects in a row. You can use that c() command to create a vector&quot; myvector &lt;- c(3,4,6,7,8,9)<br>&nbsp;&nbsp;&nbsp; - Can also find the class of a vector class(myvector)<br>&nbsp;&nbsp;&nbsp; - We can sort characters or numbers. Keep in mind that when you sort numbers that are stored as characters, things may look out of order to you. All of the numbers starting with 1 will come first (eg: 1,10,11,12,2,20). Convert to number if you want to sort it numerically (1,2,10,11,12,20)<br>&nbsp;&nbsp;&nbsp; - If you want to add new values on to a vector, you can concatenate using c() c(myvector, 3)<br>&nbsp;&nbsp;&nbsp; - Missing data. R has a special class just for missing data encoded by NA. If you want to test whether a variable is missing data or not, you can type is.na(myvector) and that will return true or false depending on if something is missing or not.&nbsp;<br>&nbsp;&nbsp;&nbsp; - A vector is a one-dimensional data type (think of it like a list).&nbsp;<br>&nbsp;&nbsp;&nbsp; - A matrix is one type of two-dimensional data.&nbsp;<br>&nbsp;&nbsp;&nbsp; - To make a new matrix:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m &lt;- matrix(1:15, nrow=3, ncol=5)<br>&nbsp;&nbsp;&nbsp; - Another two-dimensional object type is a data.frame. Matricies can only accept one type of value (so all entries must be numeric or character, you can&#x27;t mix the two). Data.frames can have a mix of both numbers and character strings.&nbsp;<br>&nbsp;&nbsp;&nbsp; - Factor is another type of data. A factor is a categorical variable.&nbsp;<br>&nbsp;&nbsp;&nbsp; - To access a single column in a data.frame, you can type the name of the data.frame, a dollar sign, and the name of the column:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; carspeeds$Color # will pull the Color column<br>&nbsp;&nbsp;&nbsp; -&nbsp;<br><br><br><br><a href="https&#x3a;&#x2F;&#x2F;www&#x2e;codecogs&#x2e;com&#x2F;latex&#x2F;eqneditor&#x2e;php">https:&#x2F;&#x2F;www.codecogs.com&#x2F;latex&#x2F;eqneditor.php</a><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>Notes for running R from command line or Gitbash in Windows<br>(these work for the Mann Lib computers)<br>First we need to find the location for a file called &quot;Rscript.exe&quot;<br>On Mann computers it is C:\Program Files\R\R-3.3.1\bin\<br><br>Click on the windows icon in the lower right hand corner, right click on &quot;Computer&quot; and choose properties<br>Click &quot;Advanced system settings&quot;<br>In the lowe right hand corner click the button for &quot;Environment Variables&quot;<br><ul class="indent"><li>If there is already a variable called PATH, click edit</li><li>If there is not a PATH variable, click New, and write &quot;PATH&quot; in the box for Variable name</li></ul>In the box for Variable value, scroll to the end, and enter the path we found above without quotes C:\Program Files\R\R-3.3.1\bin\&nbsp;<br>Click OK a bunch to get out of the settings dialogues.<br><br><br>Get to your folder with an R script (something.R)&nbsp;<br><ul class="indent"><li>either through the command line window</li><li>or by clicking to the folder, right clickign and choosing &quot;Git Bash Here&quot;.&nbsp; This will open a git bash that is already navigated ot this folder</li></ul><br>Run the script by typing at the prompt:<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; Rscript session-info.R<br><br><br><br></body>
</html>
